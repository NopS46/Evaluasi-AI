<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Guru - Evaluasi Proyek</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* Login Section */
        .login-section {
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f5f7ff 0%, #e8ecff 100%);
        }
        
        .login-section h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .login-section p {
            color: #666;
            margin-bottom: 30px;
        }
        
        .login-form {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn-login {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 100%;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            padding: 10px;
            background: #fdf2f2;
            border-radius: 5px;
            display: none;
        }
        
        /* Dashboard Section */
        .dashboard-section {
            display: none;
            padding: 40px;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e1e5e9;
        }
        
        .dashboard-title {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin-left: auto;
        }
        
        .logout-btn:hover {
            background: #c82333;
        }
        
        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-group label {
            font-weight: 600;
            color: #333;
        }
        
        .filter-group select {
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            min-width: 150px;
        }
        
        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin-left: auto;
        }
        
        .export-btn:hover {
            background: #218838;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .stat-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-card .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }
        
        .data-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .table-header {
            background: #667eea;
            color: white;
            padding: 20px;
            font-weight: 600;
        }
        
        .table-content {
            max-height: 600px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }
        
        th {
            background: #f8f9ff;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        tr:nth-child(even) {
            background: #f8f9ff;
        }
        
        tr:hover {
            background: #e8ecff;
        }
        
        .score-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
        }
        
        .score-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .save-scores-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin: 20px 0;
        }
        
        .save-scores-btn:hover {
            background: #138496;
        }
        
        .indicator-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-high {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-low {
            background: #f8d7da;
            color: #721c24;
        }
        
        .detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            width: 90%;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e1e5e9;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .detail-section {
            margin-bottom: 20px;
        }
        
        .detail-section h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .table-content {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Section -->
        <div id="loginSection" class="login-section">
            <h1>üîê Login Guru</h1>
            <p>Akses dashboard evaluasi proyek siswa</p>
            
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                
                <button type="submit" class="btn-login">üöÄ Masuk Dashboard</button>
                
                <div id="errorMessage" class="error-message">
                    Username atau password salah!
                </div>
            </form>
            
        </div>
        
        <!-- Dashboard Section -->
        <div id="dashboardSection" class="dashboard-section">
            <div class="dashboard-header">
                <div>
                    <h1 class="dashboard-title">üìä Dashboard Evaluasi Siswa</h1>
                    <p style="color: #666;">Mata Pelajaran: Dasar-Dasar Komputer Jaringan</p>
                </div>
                <button id="logoutBtn" class="logout-btn">üö™ Logout</button>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="filterKelas">Filter Kelas:</label>
                    <select id="filterKelas">
                        <option value="">Semua Kelas</option>
                        <option value="X TKJ 1">X TKJ 1</option>
                        <option value="X TKJ 2">X TKJ 2</option>
                        <option value="X TKJ 3">X TKJ 3</option>
                        <option value="XI TKJ 1">XI TKJ 1</option>
                        <option value="XI TKJ 2">XI TKJ 2</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filterNama">Filter Nama:</label>
                    <select id="filterNama">
                        <option value="">Semua Siswa</option>
                    </select>
                </div>
                
                <button id="exportBtn" class="export-btn">üìÑ Export CSV</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total Siswa</h3>
                    <div class="stat-number" id="totalSiswa">0</div>
                </div>
                <div class="stat-card">
                    <h3>Rata-rata Kreativitas</h3>
                    <div class="stat-number" id="avgKreativitas">0</div>
                </div>
                <div class="stat-card">
                    <h3>Rata-rata Problem Solving</h3>
                    <div class="stat-number" id="avgProblemSolving">0</div>
                </div>
                <div class="stat-card">
                    <h3>Tingkat Keberhasilan</h3>
                    <div class="stat-number" id="successRate">0%</div>
                </div>
            </div>
            
            <div class="data-table">
                <div class="table-header">
                    üìã Data Evaluasi Siswa
                </div>
                <div class="table-content">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Kelas</th>
                                <th>Indikator Kreativitas</th>
                                <th>Nilai Kreativitas</th>
                                <th>Indikator Problem Solving</th>
                                <th>Nilai Problem Solving</th>
                                <th>Kualitas Kabel</th>
                                <th>Uji Koneksi</th>
                                <th>Detail</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <button id="saveScoresBtn" class="save-scores-btn">üíæ Simpan Nilai Manual</button>
        </div>
    </div>
    
    <!-- Detail Modal -->
    <div id="detailModal" class="detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detail Evaluasi Siswa</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- Detail akan diisi oleh JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Sample data untuk demo
        let studentsData = [];

document.addEventListener("DOMContentLoaded", async () => {
    try {
        const res = await fetch("https://evaluasi-ai-production.up.railway.app/siswa");
        const result = await res.json();

        studentsData = result.map((item, idx) => ({
            id: item.id || idx + 1,
            nama: item.name,
            kelas: item.kelas,
            email: item.email,
            kreativitas_solusi: item.features.implementationQuality,
            kerapian: item.features.debuggingAbility,
            kesulitan_straight: item.features.projectComplexity,
            kesulitan_cross: item.features.solutionInnovation,
            pendekatan_sistematis: item.features.presentationScore,
            strategi_masalah: item.feedback?.strategi || "-",
            metode_khusus: item.feedback?.metode_khusus || "-",
            dokumentasi: item.feedback?.dokumentasi || [],
            elemen_kreatif: item.feedback?.elemen_kreatif || [],
            kesulitan_terbesar: item.feedback?.refleksi?.kesulitan || "",
            pembelajaran: item.feedback?.refleksi?.pembelajaran || "",
            saran: item.feedback?.refleksi?.saran || "",
            kualitas_kabel: "Tidak Tersedia",  // Jika tidak ada di DB
            uji_koneksi: "Tidak Tersedia",     // Jika tidak ada di DB
            kemampuan_menjelaskan: 0,          // Default jika tidak disimpan
            nilai_kreativitas_manual: item.predictions?.creativity || null,
            nilai_problemsolving_manual: item.predictions?.problemSolving || null
        }));

        filteredData = [...studentsData];
        loadDashboardData();
        addSearchFunctionality();
    } catch (error) {
        alert("Gagal memuat data siswa dari server.");
        console.error(error);
    }
});

        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'guru' && password === 'admin123') {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('dashboardSection').style.display = 'block';
                loadDashboardData();
            } else {
                document.getElementById('errorMessage').style.display = 'block';
            }
        });
        
        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('dashboardSection').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('errorMessage').style.display = 'none';
        });
        
        // Load dashboard data
        function loadDashboardData() {
            updateStats();
            updateTable();
            populateFilters();
        }
        
        // Update statistics
        function updateStats() {
            const totalSiswa = filteredData.length;
            const avgKreativitas = calculateAverageCreativity();
            const avgProblemSolving = calculateAverageProblemSolving();
            const successRate = calculateSuccessRate();
            
            document.getElementById('totalSiswa').textContent = totalSiswa;
            document.getElementById('avgKreativitas').textContent = avgKreativitas.toFixed(1);
            document.getElementById('avgProblemSolving').textContent = avgProblemSolving.toFixed(1);
            document.getElementById('successRate').textContent = successRate + '%';
        }
        
        // Calculate creativity indicator
        function calculateCreativityIndicator(student) {
            let score = 0;
            
            // Metode khusus (30%)
            if (student.metode_khusus === "Ya, saya mengembangkan teknik sendiri") score += 30;
            else if (student.metode_khusus === "Ya, saya memodifikasi sedikit") score += 20;
            
            // Kreativitas solusi (40%)
            score += (student.kreativitas_solusi / 10) * 40;
            
            // Elemen kreatif (30%)
            const elemenCount = student.elemen_kreatif.filter(e => e !== "Tidak ada").length;
            score += (elemenCount / 4) * 30;
            
            return Math.round(score);
        }
        
        // Calculate problem solving indicator
        function calculateProblemSolvingIndicator(student) {
            let score = 0;
            
            // Strategi masalah (30%)
            if (student.strategi_masalah === "Menganalisis sendiri dan mencari solusi") score += 30;
            else if (student.strategi_masalah === "Bertanya pada teman/guru sambil mencoba sendiri") score += 20;
            else if (student.strategi_masalah === "Membuat ulang dari awal") score += 15;
            else score += 10;
            
            // Pendekatan sistematis (40%)
            score += (student.pendekatan_sistematis / 10) * 40;
            
            // Waktu debugging (30%)
            const debuggingScore = {
                "Kurang dari 5 menit": 30,
                "5-15 menit": 25,
                "15-30 menit": 20,
                "30-60 menit": 15,
                "Lebih dari 1 jam": 10
            };
            score += debuggingScore[student.waktu_debugging] || 10;
            
            return Math.round(score);
        }
        
        // Calculate averages
        function calculateAverageCreativity() {
            const total = filteredData.reduce((sum, student) => {
                return sum + calculateCreativityIndicator(student);
            }, 0);
            return filteredData.length > 0 ? total / filteredData.length : 0;
        }
        
        function calculateAverageProblemSolving() {
            const total = filteredData.reduce((sum, student) => {
                return sum + calculateProblemSolvingIndicator(student);
            }, 0);
            return filteredData.length > 0 ? total / filteredData.length : 0;
        }
        
        function calculateSuccessRate() {
            const successCount = filteredData.filter(student => 
                student.uji_koneksi === "Ya, semua kabel lulus uji"
            ).length;
            return filteredData.length > 0 ? Math.round((successCount / filteredData.length) * 100) : 0;
        }
        
        // Get indicator badge
        function getIndicatorBadge(score) {
            if (score >= 80) return '<span class="indicator-badge badge-high">Tinggi (' + score + ')</span>';
            else if (score >= 60) return '<span class="indicator-badge badge-medium">Sedang (' + score + ')</span>';
            else return '<span class="indicator-badge badge-low">Rendah (' + score + ')</span>';
        }
        
        // Update table
        function updateTable() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            filteredData.forEach(student => {
                const creativityScore = calculateCreativityIndicator(student);
                const problemSolvingScore = calculateProblemSolvingIndicator(student);
                
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td><strong>${student.nama}</strong></td>
                    <td>${student.kelas}</td>
                    <td>${getIndicatorBadge(creativityScore)}</td>
                    <td><input type="number" class="score-input" min="0" max="100" 
                              value="${student.nilai_kreativitas_manual || ''}" 
                              data-student-id="${student.id}" data-type="kreativitas"
                              placeholder="0-100"></td>
                    <td>${getIndicatorBadge(problemSolvingScore)}</td>
                    <td><input type="number" class="score-input" min="0" max="100" 
                              value="${student.nilai_problemsolving_manual || ''}" 
                              data-student-id="${student.id}" data-type="problemsolving"
                              placeholder="0-100"></td>
                    <td>${student.kualitas_kabel}</td>
                    <td>${student.uji_koneksi}</td>
                    <td><button onclick="showDetail(${student.id})" 
                              style="background:#17a2b8;color:white;border:none;padding:5px 10px;border-radius:3px;cursor:pointer;">
                              üëÅÔ∏è Detail</button></td>
                `;
            });
        }
        
        // Populate filters
        function populateFilters() {
            const filterNama = document.getElementById('filterNama');
            filterNama.innerHTML = '<option value="">Semua Siswa</option>';
            
            const uniqueNames = [...new Set(studentsData.map(s => s.nama))].sort();
            uniqueNames.forEach(nama => {
                const option = document.createElement('option');
                option.value = nama;
                option.textContent = nama;
                filterNama.appendChild(option);
            });
        }
        
        // Filter functionality
        document.getElementById('filterKelas').addEventListener('change', applyFilters);
        document.getElementById('filterNama').addEventListener('change', applyFilters);
        
        function applyFilters() {
            const kelasFilter = document.getElementById('filterKelas').value;
            const namaFilter = document.getElementById('filterNama').value;
            
            filteredData = studentsData.filter(student => {
                const matchKelas = !kelasFilter || student.kelas === kelasFilter;
                const matchNama = !namaFilter || student.nama === namaFilter;
                return matchKelas && matchNama;
            });
            
            updateStats();
            updateTable();
        }
        
        // Save manual scores
        document.getElementById('saveScoresBtn').addEventListener('click', async function () {
    const scoreInputs = document.querySelectorAll('.score-input');
    for (let input of scoreInputs) {
        const studentId = parseInt(input.dataset.studentId);
        const type = input.dataset.type;
        const value = input.value ? parseInt(input.value) : null;

        const student = studentsData.find(s => s.id === studentId);
        if (!student || value === null) continue;

        if (type === 'kreativitas') {
            student.nilai_kreativitas_manual = value;
        } else if (type === 'problemsolving') {
            student.nilai_problemsolving_manual = value;
        }

        // Kirim manual ke backend jika ingin
        const response = await fetch("https://evaluasi-ai-production.up.railway.app/siswa", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                projectComplexity: student.kesulitan_straight,
                solutionInnovation: student.kesulitan_cross,
                implementationQuality: student.kreativitas_solusi,
                debuggingAbility: student.kerapian,
                presentationScore: student.pendekatan_sistematis
            })
        });

        const res = await response.json();
        console.log("Manual prediction:", res);
    }

    alert("‚úÖ Nilai manual berhasil disimpan ke backend!");
});

        
        // Export to CSV
        document.getElementById('exportBtn').addEventListener('click', function() {
            const headers = [
                'Nama', 'Kelas', 'Email', 'Kesulitan Straight', 'Kesulitan Cross',
                'Jumlah Percobaan', 'Metode Khusus', 'Kreativitas Solusi', 'Elemen Kreatif',
                'Kualitas Kabel', 'Kerapian', 'Uji Koneksi', 'Strategi Masalah',
                'Pendekatan Sistematis', 'Waktu Debugging', 'Kemampuan Menjelaskan',
                'Dokumentasi', 'Indikator Kreativitas', 'Nilai Kreativitas Manual',
                'Indikator Problem Solving', 'Nilai Problem Solving Manual',
                'Kesulitan Terbesar', 'Pembelajaran', 'Saran'
            ];
            
            let csvContent = headers.join(',') + '\n';
            
            filteredData.forEach(student => {
                const creativityScore = calculateCreativityIndicator(student);
                const problemSolvingScore = calculateProblemSolvingIndicator(student);
                
                const row = [
                    `"${student.nama}"`,
                    `"${student.kelas}"`,
                    `"${student.email}"`,
                    student.kesulitan_straight,
                    student.kesulitan_cross,
                    `"${student.jumlah_percobaan}"`,
                    `"${student.metode_khusus}"`,
                    student.kreativitas_solusi,
                    `"${student.elemen_kreatif.join('; ')}"`,
                    `"${student.kualitas_kabel}"`,
                    student.kerapian,
                    `"${student.uji_koneksi}"`,
                    `"${student.strategi_masalah}"`,
                    student.pendekatan_sistematis,
                    `"${student.waktu_debugging}"`,
                    student.kemampuan_menjelaskan,
                    `"${student.dokumentasi.join('; ')}"`,
                    creativityScore,
                    student.nilai_kreativitas_manual || '',
                    problemSolvingScore,
                    student.nilai_problemsolving_manual || '',
                    `"${student.kesulitan_terbesar || ''}"`,
                    `"${student.pembelajaran || ''}"`,
                    `"${student.saran || ''}"`
                ];
                csvContent += row.join(',') + '\n';
            });
            
            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `evaluasi_siswa_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
        
        // Show detail modal
        function showDetail(studentId) {
            const student = studentsData.find(s => s.id === studentId);
            if (!student) return;
            
            const creativityScore = calculateCreativityIndicator(student);
            const problemSolvingScore = calculateProblemSolvingIndicator(student);
            
            document.getElementById('modalTitle').textContent = `Detail Evaluasi - ${student.nama}`;
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div class="detail-section">
                    <h4>üë§ Data Siswa</h4>
                    <p><strong>Nama:</strong> ${student.nama}</p>
                    <p><strong>Kelas:</strong> ${student.kelas}</p>
                    <p><strong>Email:</strong> ${student.email}</p>
                </div>
                
                <div class="detail-section">
                    <h4>üîß Kompleksitas Proyek</h4>
                    <p><strong>Kesulitan Straight:</strong> ${student.kesulitan_straight}/10</p>
                    <p><strong>Kesulitan Cross:</strong> ${student.kesulitan_cross}/10</p>
                    <p><strong>Jumlah Percobaan:</strong> ${student.jumlah_percobaan}</p>
                </div>
                
                <div class="detail-section">
                    <h4>üí° Inovasi dan Kreativitas</h4>
                    <p><strong>Metode Khusus:</strong> ${student.metode_khusus}</p>
                    <p><strong>Kreativitas Solusi:</strong> ${student.kreativitas_solusi}/10</p>
                    <p><strong>Elemen Kreatif:</strong> ${student.elemen_kreatif.join(', ')}</p>
                    <p><strong>Indikator Kreativitas:</strong> ${getIndicatorBadge(creativityScore)}</p>
                    <p><strong>Nilai Manual:</strong> ${student.nilai_kreativitas_manual || 'Belum dinilai'}</p>
                </div>
                
                <div class="detail-section">
                    <h4>‚ö° Kualitas Implementasi</h4>
                    <p><strong>Kualitas Kabel:</strong> ${student.kualitas_kabel}</p>
                    <p><strong>Kerapian:</strong> ${student.kerapian}/10</p>
                    <p><strong>Uji Koneksi:</strong> ${student.uji_koneksi}</p>
                </div>
                
                <div class="detail-section">
                    <h4>üß© Problem Solving</h4>
                    <p><strong>Strategi Masalah:</strong> ${student.strategi_masalah}</p>
                    <p><strong>Pendekatan Sistematis:</strong> ${student.pendekatan_sistematis}/10</p>
                    <p><strong>Waktu Debugging:</strong> ${student.waktu_debugging}</p>
                    <p><strong>Indikator Problem Solving:</strong> ${getIndicatorBadge(problemSolvingScore)}</p>
                    <p><strong>Nilai Manual:</strong> ${student.nilai_problemsolving_manual || 'Belum dinilai'}</p>
                </div>
                
                <div class="detail-section">
                    <h4>üìã Presentasi dan Dokumentasi</h4>
                    <p><strong>Kemampuan Menjelaskan:</strong> ${student.kemampuan_menjelaskan}/10</p>
                    <p><strong>Dokumentasi:</strong> ${student.dokumentasi.join(', ')}</p>
                </div>
                
                <div class="detail-section">
                    <h4>üí≠ Refleksi</h4>
                    <p><strong>Kesulitan Terbesar:</strong></p>
                    <p style="margin-left: 20px; font-style: italic;">${student.kesulitan_terbesar || 'Tidak diisi'}</p>
                    <p><strong>Pembelajaran:</strong></p>
                    <p style="margin-left: 20px; font-style: italic;">${student.pembelajaran || 'Tidak diisi'}</p>
                    <p><strong>Saran:</strong></p>
                    <p style="margin-left: 20px; font-style: italic;">${student.saran || 'Tidak diisi'}</p>
                </div>
            `;
            
            document.getElementById('detailModal').style.display = 'block';
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // Initialize tooltips for indicators
        document.addEventListener('DOMContentLoaded', function() {
            // Add CSS for tooltips
            const style = document.createElement('style');
            style.textContent = `
                .tooltip {
                    position: relative;
                    cursor: help;
                }
                
                .tooltip:hover::after {
                    content: attr(data-tooltip);
                    position: absolute;
                    bottom: 100%;
                    left: 50%;
                    transform: translateX(-50%);
                    background: #333;
                    color: white;
                    padding: 8px 12px;
                    border-radius: 4px;
                    font-size: 12px;
                    white-space: nowrap;
                    z-index: 1000;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                }
                
                .tooltip:hover::before {
                    content: '';
                    position: absolute;
                    bottom: 94%;
                    left: 50%;
                    transform: translateX(-50%);
                    border: 4px solid transparent;
                    border-top-color: #333;
                    z-index: 1000;
                }
            `;
            document.head.appendChild(style);
        });
        
        // Add real-time search functionality
        function addSearchFunctionality() {
            const searchInput = document.createElement('input');
            searchInput.type = 'text';
            searchInput.placeholder = 'üîç Cari nama siswa...';
            searchInput.style.cssText = `
                padding: 10px 15px;
                border: 2px solid #e1e5e9;
                border-radius: 8px;
                font-size: 14px;
                width: 250px;
                margin-right: 15px;
            `;
            
            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                filteredData = studentsData.filter(student => {
                    const matchSearch = student.nama.toLowerCase().includes(searchTerm);
                    const kelasFilter = document.getElementById('filterKelas').value;
                    const namaFilter = document.getElementById('filterNama').value;
                    const matchKelas = !kelasFilter || student.kelas === kelasFilter;
                    const matchNama = !namaFilter || student.nama === namaFilter;
                    return matchSearch && matchKelas && matchNama;
                });
                
                updateStats();
                updateTable();
            });
            
            const filtersDiv = document.querySelector('.filters');
            filtersDiv.insertBefore(searchInput, filtersDiv.firstChild);
        }
        
        // Initialize search functionality after login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'guru' && password === 'admin123') {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('dashboardSection').style.display = 'block';
                loadDashboardData();
                addSearchFunctionality();
            } else {
                document.getElementById('errorMessage').style.display = 'block';
            }
        });
    </script>
</body>
</html>